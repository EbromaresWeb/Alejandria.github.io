<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Inicia Sesion</title>
    <link href="https://fonts.googleapis.com/css2?family=Staatliches&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="WebFinal/css/style.css">
    <!-- Carga el núcleo de Firebase JS SDK -->
    <!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>

<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
<script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-auth.js"></script>
    
    <script
    src="https://www.gstatic.com/firebasejs/8.3.1/firebase-firestore.js">
    </script>
    <script src="WebFinal/Js/init.js"></script>
    
  </head>
  <body>
   <h1> Autenticacion</h1>
    <h2> Sesion</h2>
    <fieldset>
      <p> Email </p>
      <outpu id="email"><progress mx="100"> Cargando... </progress></output>
      </fieldset>
     <fieldset>
      <p> Nombre </p>
      <outpu id="nombre"></output>
      </fieldset>
    <button type="button" onclick="terminaSesión()"> Terminar Sesion </button>
    
    <footer class="footer">
        <div class="contenedor">
            <div class="barra">
                <a class="logo" href="https://www.linkedin.com/in/mario-jafet-ebromares-fuentes-a2b023197/">
                    <h1 class="logo__nombre no-margin centrar-texto">Mario<span class="logo__bold">Ebromares</span></h1>
                </a>
            </div>
        </div>
    </footer>
    <script>
        const auth = firebase.auth();
        const provider = new firebase.auth.GoogleAuthProvider();
        provider.setCustomParameters({ prompt: "select_account"});
        auth.onAuthStateChanged(
        usuarioAuth => {
          if (usuarioAuth && usuarioAuth.email){
            email.value = usuarioAuth.email;
            nombre.value = usuarioAuth.displayName;
            avatar.src = usuarioAuth.photoURL;
          }
          else{
            auth.signInWithRedirect(provider);
          }
        },
          );
      async function terminaSesión(){
        try{
            await auth.signOut();
        } catch (e){
            procesaError(e);
        }
      }
      function procesaError(e){
          console.log(e);
          alert(e.message);
      }
    </script>
          
      
  </body>
</html>
